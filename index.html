<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        td,th{border:solid 2px #575757;padding:1px 10px}
        table{border-collapse:collapse;}
    </style>
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.bundle.min.js"></script>
    <script>
        function calc(formula){
            formula=formula.replace("＋","+").replace("ー","-").replace("＊","*")
            if(formula.match(/\+/)){
                var sum=formula.match(/(\d+)\+(\d+)/)
                sum=sum[0].match(/\d+/g)
                sum=Number(sum[0])+Number(sum[1])
                console.log(sum)
            }
        }
        function drow(){
            var p=document.getElementById("p").value
            var q=document.getElementById("q").value
            var an=[document.getElementById("a0").value]
            p=p.replace(/([^\+\-\*\/])n/gi,"$1*n")
            q=q.replace(/([^\+\-\*\/])n/gi,"$1*n")
            p=p.replace("＋","+").replace("ー","-").replace("＊","*")
            if(p.match(/[^\d\+\-*\/n\^()]/)){return alert("四則演算とべき乗以外は使えません")}
            if(q.match(/[^\d\+\-*\/n\^()]/)){return alert("四則演算とべき乗以外は使えません")}
            if(p=="")p="0"
            if(q=="")q="0"

            for(var a=1;a<11;a++){   
                p1=p.replace(/n/g,a).replace(/\^/g,"**")
                q1=q.replace(/n/g,a).replace(/\^/g,"**")
                an.push((eval(p1))*an[a-1]+eval(q1))
            }


            var table=document.getElementById("table")
            table.hidden=false
            for(var i=1;i<11;i++){
                table.rows[1].cells[i-1].innerText=an[i-1]
            }
        }
        
    </script>
</head>
<body>
    <form id="form1" name="form1">
    \(a_1=\) <input type="text" style="width:100px;" id="a0"><br>
    \(a_{n+1}=\) <input type="text" id="p" style="width:100px;"> \( a_n\)+<input type="text" id="q" style="width:100px;">
    <br>
    <input type="button" onclick="drow()" value="test">
    <br><br>

    <table id="table" hidden>
        <tr><td>\(a_1\)</td><td>\(a_2\)</td><td>\(a_3\)</td><td>\(a_4\)</td><td>\(a_5\)</td><td>\(a_6\)</td><td>\(a_7\)</td><td>\(a_8\)</td><td>\(a_9\)</td><td>\(a_{10}\)</td></tr>
        <tr><td name="a1">1</td><td name="a2"></td><td name="a3"></td><td name="a4"></td><td name="a5"></td><td name="a6"></td><td name="a7"></td><td name="a8"></td><td name="a9"></td><td name="a10"></td></tr>
    </table>

    <canvas id="charts"></canvas>
</form>
</body>
</html>
